<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function to generate the parameter matrix for HMMcopy::HMMsegment(). Set-up with default values for single-cell analysis."><title>Single Cell HMMcopy parameters — params_sc_hmm • scatools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single Cell HMMcopy parameters — params_sc_hmm"><meta property="og:description" content="Function to generate the parameter matrix for HMMcopy::HMMsegment(). Set-up with default values for single-cell analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scatools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/scatools.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mjz1/scatools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Single Cell HMMcopy parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/mjz1/scatools/blob/HEAD/R/hmmcopy_utils.R" class="external-link"><code>R/hmmcopy_utils.R</code></a></small>
      <div class="d-none name"><code>params_sc_hmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to generate the parameter matrix for <code><a href="https://rdrr.io/pkg/HMMcopy/man/HMMsegment.html" class="external-link">HMMcopy::HMMsegment()</a></code>. Set-up with default values for single-cell analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">params_sc_hmm</span><span class="op">(</span></span>
<span>  e <span class="op">=</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.000001</span><span class="op">)</span>,</span>
<span>  strength <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">11</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  nu <span class="op">=</span> <span class="fl">2.1</span>,</span>
<span>  kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">700</span>, <span class="fl">100</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  m <span class="op">=</span> <span class="va">mu</span>,</span>
<span>  eta <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  S <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>e</dt>
<dd><p>Probability of extending a segment, increase to lengthen segments, decrase to shorten segments. Range: (0, 1)</p></dd>


<dt>strength</dt>
<dd><p>Strength of initial <code>e</code> suggestion, reducing allows e to change, increasing makes e undefinable. Range: [0, Inf)</p></dd>


<dt>mu</dt>
<dd><p>Suggested median for copy numbers in state, change to readjust classification of states. Range: (-Inf, Inf)</p></dd>


<dt>lambda</dt>
<dd><p>Suggested precision (inversed variance) for copy numbers in state, increase to reduce overlap between states. Range: [0, Inf)</p></dd>


<dt>nu</dt>
<dd><p>Suggested degree of freedom between states, increase to reduce overlap between states. Range: [0, Inf)</p></dd>


<dt>kappa</dt>
<dd><p>Suggested distribution of states. Should sum to 1. Must be same length as <code>mu</code>.</p></dd>


<dt>m</dt>
<dd><p>Optimal value for mu, difference from corresponding mu value determines elasticity of the mu value. i.e. Set to identical value as mu if you don't want mu to move much.</p></dd>


<dt>eta</dt>
<dd><p>Mobility of mu, increase to allow more movement. Range: [0, Inf)</p></dd>


<dt>gamma</dt>
<dd><p>Prior shape on lambda, gamma distribution. Effects flexibility of lambda.</p></dd>


<dt>S</dt>
<dd><p>Prior scale on lambda, gamma distribution. Effects flexibility of lambda.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data frame of parameters for <code><a href="https://rdrr.io/pkg/HMMcopy/man/HMMsegment.html" class="external-link">HMMcopy::HMMsegment()</a></code></p>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code><a href="https://rdrr.io/pkg/HMMcopy/man/HMMsegment.html" class="external-link">HMMsegment</a></code> is a two stage algorithm that first runs an
  Expectation-Maximization algorithm to find the optimal set of parameters
  based on suggested parameter inputs, and allowed flexibilities.  After
  iteratively finding the optimal parameters, the actual segmentation of the
  data is conducted with the Viterbi algorithm, finally output segmented
  states.  This is an extension to the hidden Markov model described in Shah
  et al., 2006.</p>
<p>Parameters are divided into two main categories:</p><ul><li><p>Initial parameters: e, mu, lambda, nu, kappa</p></li>
<li><p>Flexibility parameters: strength, m, eta, gamma, S</p></li>
</ul><p>Where <em>initial parameters</em> are treated as starting suggestions for the
  parameter optimization algorithm, and flexibility parameters (hyperparameters)
  define how much the initial parameters are allowed to deviate during the
  search for the optimal parameters.</p>
<p>With a good copy number dataset, in theory, given enough flexibility, the
  algorithm should always find a similar set of optimal parameters regardless
  of initial parameters (although running times will vary).</p>
<p>If for some reason you wish to <em>manually</em> set the parameters for the
  final segmentation process, one should tune all flexibility parameters to
  minimal values.  For example, if you wish to increase the length of segments,
  you could set:</p><div class="sourceCode"><pre><code><span></span>
<span>    <span class="va">param</span><span class="op">$</span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fl">0.9999999999999999</span></span>
<span>    <span class="va">param</span><span class="op">$</span><span class="va">strength</span> <span class="op">&lt;-</span> <span class="fl">1e30</span></span>
<span>  </span></code></pre></div>

<p>Which suggests that segments should be very long, and gives minimal to
  non-existant flexibility to your suggestion.</p>
<p>See vignette for diagrammed example:</p><div class="sourceCode"><pre><code><span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span><span class="st">"HMMcopy"</span><span class="op">)</span></span>
<span>  </span></code></pre></div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">param</span> <span class="op">&lt;-</span> <span class="fu">params_sc_hmm</span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matthew Zatzman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

